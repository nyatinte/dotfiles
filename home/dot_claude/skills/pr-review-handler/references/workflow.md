# PRレビュー対応ワークフロー

## 概要

このスキルは、PRレビューコメントに体系的に対応するためのものです。レビュアーのフィードバックに対して構造化された対応を行い、コード品質を向上させることに焦点を当てています。

## ワークフローステップ

### 1. Unresolvedレビューコメントを取得

`scripts/get_unresolved_reviews.sh`を使用して、すべてのunresolvedレビュースレッドを取得:

```bash
./scripts/get_unresolved_reviews.sh <owner> <repo> <pr_number>
```

出力: unresolvedレビュースレッドとコメント詳細のJSON配列

### 2. 各コメントを表示

各unresolvedコメントについて、以下を表示:
- コメント番号: `[1/5]`
- ファイルパスと行番号: `src/utils/helper.ts:42`
- レビュアー: `@username`
- コメント本文(マークダウン形式)
- 関連するコード(diffHunkまたはファイル読み取りから)

### 3. 分析と修正案の提示

各コメントに対して:
1. レビュアーの懸念を分析
2. `path`と`line`情報を使用して現在のコードを読む
3. 詳細な修正提案を生成し、以下を説明:
   - 問題点は何か
   - なぜ問題なのか
   - どう修正するか(具体的なコード変更)
   - 修正するファイルと行番号

### 4. ユーザーが修正を実装

ユーザーが自分のエディタで提案された修正を手動で実装します。

### 5. コメント単位でコミット作成

ユーザーが修正を実装した後、そのレビューコメント専用のコミットを作成:

```bash
git add <修正したファイル>
git commit -m "fix: <簡潔な説明>

PR #<番号>の@reviewerからのレビューコメントに対応
<何を修正したか、なぜ修正したかの詳細説明>
"
```

**重要**: 履歴を明確にし追跡しやすくするため、レビューコメント1つにつき1コミット。

### 6. ユーザーが手動で返信(人間味!)

ユーザーがGitHub上でレビューコメントへの返信を手動で作成・投稿します。
これにより、コードレビューの会話における人間らしさと個人的なタッチが保たれます。

返信の例:
- "Fixed in <commit-hash>! Good catch, thanks!"
- "ご指摘のより堅牢なエラーハンドリングに更新しました。レビューありがとうございます!"
- "確かに!ご指摘のパターンに従ってリファクタリングしました。"

### 7. すべてのコメントに対して繰り返し

ステップ2-6を繰り返して、すべてのunresolvedコメントを処理します。

### 8. サマリー

すべてのコメント処理後、以下を表示:
- 処理したコメントの総数
- 作成したコミット数
- 変更をpushするリマインダー: `git push`

## 注意事項

- 常に1つのコメントずつ処理する
- コミットは集中的かつアトミックに保つ
- すべての人間的なコミュニケーション(返信、resolve)はユーザーに任せる
- REVIEW_NOTES_{PR_NUMBER}.mdで進捗を追跡
